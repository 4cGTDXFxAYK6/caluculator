<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<title>履歴付き電卓</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#000000">

<style>
  :root{
    --bg:#000;
    --panel:rgba(255,255,255,0.08);
    --btn-dark:#333;
    --btn-gray:#a5a5a5;
    --btn-accent:#ff9f0a;
    --neg:#ff3b30;
    --row-b: rgba(255,255,255,0.18);
    --border: rgba(255,255,255,0.25);
  }

  html,body{
    height:100%;
    margin:0;
    background:var(--bg);
    font-family:-apple-system, BlinkMacSystemFont, "SF Pro Text", "SF Pro Display",
                 "Helvetica Neue", Arial, sans-serif;
    touch-action: manipulation;
  }

  body{
    display:flex;
    align-items:center;
    justify-content:center;
  }

  .calculator{
    width:100%;
    max-width:600px;
    margin:auto;
    padding:16px;
    padding-bottom:40px;
    display:flex;
    flex-direction:column;
    gap:0;
    box-sizing:border-box;
  }

  .history{
    background:var(--panel);
    backdrop-filter:blur(8px);
    color:#fff;
    height:300px;
    padding:12px 8px;
    border-radius:14px;
    overflow:auto;
    font-size:21px;
    line-height:1.0;
    margin-bottom:14px;
  }

  .history-line{
    padding:6px 6px;
    border-radius:4px;
    display:flex;
    align-items:center;
    gap:10px;
    white-space:nowrap;
    overflow-x:auto;
    scrollbar-width:none;
    border-bottom:1px solid rgba(255,255,255,0.18);
  }
  .history-line::-webkit-scrollbar{ display:none; }
  .history-line:nth-child(even){ background:var(--row-b); }

  .text{
    flex:1;
    overflow:hidden;
    text-overflow:ellipsis;
  }

  .delete-btn{
    flex-shrink:0;
    color:var(--btn-accent);
    font-size:26px;
    font-weight:700;
    cursor:pointer;
    padding:0 8px;
  }

  .total-box{
    background:rgba(255,255,255,0.10);
    backdrop-filter:blur(6px);
    color:#fff;
    padding:12px 16px;
    border-radius:12px;
    font-size:26px;
    text-align:right;
    margin:0;
  }

  .keys{
    display:grid;
    grid-template-columns:repeat(4, 1fr);
    gap:0;
    width:100%;
    margin:0;
  }

  button{
    position:relative;
    overflow:hidden;

    height:56px;
    min-height:48px;
    max-height:64px;

    border-radius:0;
    border:1px solid var(--border);

    font-size:24px;
    line-height:1;

    color:#fff;
    cursor:pointer;
    user-select:none;
    font-family:inherit;

    transition:
      transform 0.05s ease-out,
      background-color 0.05s ease-out,
      box-shadow 0.05s ease-out,
      border-color 0.05s ease-out,
      color 0.05s ease-out;
  }

  .pressed{
    background-color: rgba(255,255,255,0.65);
    transform: scale(.85);
    box-shadow:
      inset 0 0 28px rgba(255,255,255,0.9),
      0 0 16px rgba(255,255,255,0.6);
    border-color: var(--btn-accent);
    color:#000;
  }

  .ripple{
    position:absolute;
    border-radius:50%;
    background:rgba(255,255,255,0.55);
    transform:scale(0);
    animation:ripple-effect 0.45s ease-out;
    pointer-events:none;
  }

  @keyframes ripple-effect{
    to{
      transform:scale(3.2);
      opacity:0;
    }
  }

  .gray{ background:var(--btn-gray); color:#000; }
  .dark{ background:var(--btn-dark); }
  .orange{ background:var(--btn-accent); }

  .zero{
    grid-column:span 2;
    text-align:left;
    padding-left:28px;
  }

  /* ---------------------------------------------------------
     ▼ iPad 縦向き（もっと大きく）
     --------------------------------------------------------- */
  @media (min-device-width: 768px) and (max-device-width: 1024px) and (orientation: portrait){
    .calculator{
      max-width:720px;      /* ← 600 → 720 に拡大 */
      transform:scale(1.15); /* ← 全体を1.15倍に拡大 */
      transform-origin: top center;
    }
    button{
      height:72px;          /* ← 64 → 72 に拡大 */
      font-size:28px;       /* ← 26 → 28 に拡大 */
    }
    .history{
      font-size:25px;       /* ← 23 → 25 に拡大 */
    }
  }

  /* ---------------------------------------------------------
     ▼ iPad 横向き（前回のままOK）
     --------------------------------------------------------- */
  @media (min-device-width: 768px) and (max-device-width: 1024px) and (orientation: landscape){
    .calculator{
      max-width:700px;
      transform:scale(1.1);
      transform-origin: top center;
    }
    button{
      height:64px;
      font-size:26px;
    }
    .history{
      font-size:23px;
    }
  }

</style>
</head>
<body>

<!-- ここから下は前回と同じ（省略なし） -->

<div class="calculator">

  <div id="history" class="history"></div>

  <div id="totalBox" class="total-box">合計: 0</div>

  <div class="keys">
    <button class="gray" data-value="DEL">⌫</button>
    <button class="gray" data-value="AC">AC</button>
    <button class="gray" data-value="%">%</button>
    <button class="orange" data-value="/">÷</button>

    <button class="dark" data-value="7">7</button>
    <button class="dark" data-value="8">8</button>
    <button class="dark" data-value="9">9</button>
    <button class="orange" data-value="*">×</button>

    <button class="dark" data-value="4">4</button>
    <button class="dark" data-value="5">5</button>
    <button class="dark" data-value="6">6</button>
    <button class="orange" data-value="-">-</button>

    <button class="dark" data-value="1">1</button>
    <button class="dark" data-value="2">2</button>
    <button class="dark" data-value="3">3</button>
    <button class="orange" data-value="+">+</button>

    <button class="dark zero" data-value="0">0</button>
    <button class="dark" data-value=".">.</button>
    <button class="orange" data-value="=">=</button>
  </div>
</div>

<script>
/* JavaScript部分は前回と同じ（省略なし） */
</script>

</body>
</html>

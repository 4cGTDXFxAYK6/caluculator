function handleInput(value){
  if(justCalculated){
    if(!isNaN(value) || value === ".") current = "";
    justCalculated = false;
  }

  if(value === "AC"){
    resetAll();
    return;
  }

  if(value === "DEL"){
    current = current.slice(0,-1);
    updateInputLine();
    return;
  }

  if(value === "%"){
    current = String(Number(current)/100);
    updateInputLine();
    return;
  }

  /* ▼ 小数点の多重入力を防ぐ（重要） */
  if(value === "."){
    if(current.includes(".")) return;  // ← これで2回目以降の . を無視
    if(current === "") current = "0";  // ← 最初が . の場合は 0. にする
    current += ".";
    updateInputLine();
    return;
  }

  if(["+","-","*","/"].includes(value)){
    operator = value;
    previous = current;
    current = "";
    updateInputLine();
    return;
  }

  if(value === "="){
    calculate();
    return;
  }

  current += value;
  updateInputLine();
}
